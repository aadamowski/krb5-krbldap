Tue Jan 16 13:52:22 1996  Sam Hartman  <hartmans@tertius.mit.edu>

	* logwtmp.c (pty_logwtmp): Pass user argument to update_wtmp.

	* update_utmp.c (update_utmp): Implement PTY_UTMP_USERNAME_VALID flag

Mon Jan 15 15:48:37 1996  Sam Hartman  (hartmans@justforfun)

	* cleanup.c: Change to indiciate utmp user name is valid.

	* 

Mon Jan 15 15:21:16 1996  Sam Hartman  <hartmans@tertius.mit.edu>

	* update_utmp.c (pty_update_utmp): Add flags field; use ttyslot
        only if reasonable.

Fri Jan 12 16:33:37 1996  Sam Hartman  <hartmans@infocalypse>

	* open_slave.c (pty_open_slave): Don't use fchmod or fchown; they
 	don't buy much security unless /dev is world-writable and may
 	prevent Solaris lossage.

Thu Dec 21 00:12:58 1995  Sam Hartman  <hartmans@portnoy>

	* open_slave.c (pty_open_slave): Open with no delay.


Wed Jan 10 22:20:04 1996  Theodore Y. Ts'o  <tytso@dcl>

	* open_slave.c (pty_open_slave): Added hack by Doug Engbert to get
		util/pty to work under Solaris.  We should double check to
		make sure this is a correct fix.


Sun Nov 12 12:44:33 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* open_ctty.c (pty_open_ctty): Remove redundant Ultrix calls to setpgrp()

Sun Oct 22 03:48:37 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* update_wtmp.c (ptyint_update_wtmp): Add comments explaining why ifdefs are right.

Sun Oct 22 01:20:52 1995  Sam Hartman  <hartmans@infocalypse>

	* update_wtmp.c (ptyint_update_wtmp): Try utx not uts.

Mon Oct 16 17:41:45 1995  Sam Hartman  <hartmans@tertius.mit.edu>



	* update_wtmp.c (ptyint_update_wtmp): Update to take host name, so
        we can get the full host name if it is chopped in utmp.
	* update_wtmp.c (ptyint_update_wtmp):  Insert fallback path for Sunos and others, return defined value.




	* update_utmp.c (pty_update_utmp): Incorperate utmpx handling patch from ramus@nersc.gov to deal with support for longer hostanmes in utmpx.


*update_utmp.c: Add return statement and fallback path for Sunos.

Sat Oct 14 20:49:40 1995  Sam Hartman  <hartmans@tertius.mit.edu>
Fri Aug 11 17:49:36 1995  Samuel D Hartman  (hartmans@vorlon)


Fri Sep 29 14:18:03 1995  Theodore Y. Ts'o  <tytso@dcl>
	* update_wtmp.c (ptyint_update_wtmp): If EMPTY not defined as a
        utmp type, use DEAD_PROCESS.



	* configure.in:
	* Makefile.in: Use the SubdirLibraryRule defined in aclocal.m4 to
		create the DONE file (and to properly clean it up).

Mon Sep 25 16:42:36 1995  Theodore Y. Ts'o  <tytso@dcl>

	* Makefile.in: Removed "foo:: foo-$(WHAT)" lines from the
		Makefile. 

Thu Sep  7 19:13:05 1995  Mark Eichin  <eichin@cygnus.com>

	* update_utmp.c: ultimately fall back to /etc/utmp for UTMP_FILE,
	if it is still missing after all previous efforts.
	* update_wtmp.c: /usr/adm/wtmp for WTMP_FILE likewise.

Thu Aug 24 18:40:48 1995  Theodore Y. Ts'o  <tytso@dcl>

	* .Sanitize: Update file list

Tue Aug 15 21:42:16 1995    <tytso@rsts-11.mit.edu>

	* update_wtmp.c (ptyint_update_wtmp): If EMPTY is not defined,
		then set ut.ut_type to 0 instead.



Fri Aug 11 15:49:30 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* Makefile.in (CFILES): Rename initialize_slave.c to init_slave.c
        so it isn't truncated in libpty.a.

Fri Aug 11 01:12:03 1995  Sam Hartman  <hartmans@infocalypse>

	* initialize_slave.c (pty_initialize_slave): You really do need to
        push and pop the streams on a Sun. 

Fri Aug 11 00:49:23 1995  Sam Hartman  <hartmans@dragons-lair.MIT.EDU>

	* configure.in (ac_cv_func_setsid): Pretend that Ultrix doesn't
        have setsid, because if it does make the call then the pty never
        becomes controlling tty.

Thu Aug 10 09:47:07 1995  Sam Hartman  <hartmans@dragons-lair.MIT.EDU>

	* open_ctty.c (pty_open_ctty): Move setpgrp() after void_assoc call

Wed Aug  9 00:16:40 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* pty-int.h (VHANG_first): Change defines so VHANG_FIRST doesn't
        get defined under Ultrix because Ultrix can only establish
        controlling terminal once per process and we need to get
        controlling terminal again after vhangup().

	* getpty.c (pty_getpty): Use the right test for slave buffer length.

Tue Aug  8 22:20:33 1995  Tom Yu  <tlyu@lothlorien.MIT.EDU>

	* update_utmp.c (UTMP_FILE): _PATH_UTMP under NetBSD, not
		_UTMP_PATH; also fix typo (missing '&' on reference to
		ent)

Tue Aug  8 20:47:01 1995  Tom Yu  <tlyu@dragons-lair.MIT.EDU>

	* update_utmp.c (pty_update_utmp): change #ifdef NO_UT_PID to
		#ifndef

Tue Aug  8 09:13:50 1995  Sam Hartman  <hartmans@pao.mit.edu>

	* open_slave.c (pty_open_slave): Dissociate from controlling
        terminal before calling revoke.
	(pty_open_slave): Don't ask for a controlling terminal unless we need it.

Tue Aug  8 20:32:08 1995  Tom Yu  <tlyu@dragons-lair.MIT.EDU>

	* update_utmp.c: flush preprocessor directive to left margin.
	* pty_err.et: Fix typo in error description.

	* cleanup.c (pty_cleanup): Don't change slave before revoking it.  Also return a value all the time, not just on systems without revoke.


	* update_utmp.c (pty_update_utmp): Move #ifdef back to column 1.

Mon Aug  7 17:41:39 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* cleanup.c (pty_cleanup): Call pty_update_utmp using new interface.

	* update_utmp.c logwtmp.c : Call ptyint_update_wtmp not pty_update_wtmp.

	* cleanup.c (pty_cleanup): We can't use pid_t because we need to
        use something in libpty.h and we can't wait for pid_t to be
        defined there because we may not have configure.

	* update_wtmp.c (pty_update_wtmp): Rename to ptyint_update_wtmp.

	* update_utmp.c (pty_update_utmp): Change interface so it doesn't take a struct utmp.

	* libpty.h: Remove pty_update_wtmp as it's becoming  an internal interface.

Sat Aug  5 01:00:35 1995  Ezra Peisach  <epeisach@kangaroo.mit.edu>

	* open_slave.c (pty_open_slave): pty_open_ctty returns != 0 on
		error, not less than.

Fri Aug  4 13:59:11 1995  Theodore Y. Ts'o  <tytso@dcl>

	* libpty.h (pty_cleanup): Fix argument type of pid to patch that
		used in the C file.  Include <utmpx.h> if present.  Only
		include <utmp.h> if it is present.
	
	* configure.in: Check for utmp.h and utmpx.h

Fri Aug  4 00:59:20 1995  Tom Yu  <tlyu@dragons-lair.MIT.EDU>

	* Makefile.in: use libupdate so to not get multiple copies of
		object files upon rebuild.

	* vhangup.c (ptyint_vhangup): Make sure preprocessor directives
		are at left margin.

	* open_slave.c (pty_open_slave): Make sure preprocessor directives
		are at left margin.

	* open_ctty.c (pty_open_ctty): Make sure preprocessor directives
		are at left margin.

	* cleanup.c (pty_cleanup): Add missing declarations for retval and
		fd.  Also, align preprocessor directives with left margin.

Thu Aug  3 15:04:34 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* configure.in: Check for vhangup and killpg.

	* cleanup.c (pty_cleanup): Kill the process group associated with
        the pty if using revoke.  This won't always work, but will at
        least attempt to remove processes associated with the pty.

Wed Aug  2 11:59:19 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* init.c (pty_init): New file to handle initialization--currently only error tables.

	* getpty.c (pty_getpty): Reverse sense of logic tests so they work.  

Tue Aug  1 08:20:06 1995  Sam Hartman  <hartmans@tertius.mit.edu>

	* cleanup.c (pty_cleanup): Allow pid to be zero (unknown).

	* pty-int.h: Define VHANG_FIRST and VHANG_LAST based on presence
        of vhangup.

	* pty_err.et: Define PTY_GETPTY_SLAVE_TOOLONG

	* getpty.c (pty_getpty): Close slave side if we call openpty.

	(pty_getpty): Take length parameter; return error if it isn't big enough.



Tue Aug  1 12:06:14 1995  Ezra Peisach  <epeisach@kangaroo.mit.edu>

	* open_ctty.c (pty_open_ctty): Fixed typo TIOCSTTY to TIOCSCTTY.


