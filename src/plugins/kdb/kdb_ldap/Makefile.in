thisconfigdir=../../..
myfulldir=plugins/kdb/kdb_ldap
mydir=plugins/kdb/kdb_ldap
BUILDTOP=$(REL)..$(S)..$(S)..
KRB5_RUN_ENV = @KRB5_RUN_ENV@
KRB5_CONFIG_SETUP = KRB5_CONFIG=$(SRCTOP)/config-files/krb5.conf ; export KRB5_CONFIG ;
PROG_LIBPATH=-L$(TOPLIBD)
PROG_RPATH=$(KRB5_LIBDIR)
DEFS = @DEFS@ -DHAVE_LDAP_H
MODULE_INSTALL_DIR = $(KRB5_DB_MODULE_DIR)

LOCALINCLUDES = -I../../../lib/kdb -I$(srcdir)/../../../lib/kdb \
	-I$(srcdir)/../../../lib/kdb_ldap

LIBBASE=kldap
LIBMAJOR=0
LIBMINOR=0
SO_EXT=.so
RELDIR=../plugins/kdb/kdb_ldap
# Depends on libk5crypto and libkrb5
# Also on gssrpc, for xdr stuff.
SHLIB_EXPDEPS = \
	$(GSSRPC_DEPLIBS) \
	$(TOPLIBD)/libk5crypto$(SHLIBEXT) \
	$(TOPLIBD)/libkrb5$(SHLIBEXT)
SHLIB_EXPLIBS=$(GSSRPC_LIBS) -lkrb5 -lcom_err -lk5crypto $(LIBS)
SHLIB_DIRS=-L$(TOPLIBD)
SHLIB_RDIRS=$(KRB5_LIBDIR)

SRCS= 	$(srcdir)/ldap_exp.c

STOBJLISTS=OBJS.ST
STLIBOBJS= ldap_exp.o

all-unix:: $(LIBBASE)$(SO_EXT) lib$(LIBBASE)$(SO_EXT)
install-unix:: install-libs
clean-unix:: clean-libs clean-libobjs

lib$(LIBBASE)$(SO_EXT): $(LIBBASE)$(SO_EXT)
	ln -sf $(LIBBASE)$(SO_EXT) lib$(LIBBASE)$(SO_EXT)
#	$(CC) -shared -o $@ -L$(TOPLIBD) $^ -ldb $(SHLIB_EXPLIBS)

clean::
	$(RM) lib$(LIBBASE)$(SO_EXT) ldap_exp.o

# @libnover_frag@
# @libobj_frag@

# +++ Dependency line eater +++
# 
# Makefile dependencies follow.  This must be the last section in
# the Makefile.in file
#
ldap_exp.so ldap_exp.po $(OUTPRE)ldap_exp.$(OBJEXT): \
  ldap_exp.c $(SRCTOP)/include/k5-int.h $(BUILDTOP)/include/osconf.h \
  $(BUILDTOP)/include/autoconf.h $(SRCTOP)/include/k5-platform.h \
  $(SRCTOP)/include/k5-thread.h $(BUILDTOP)/include/krb5.h \
  $(COM_ERR_DEPS) $(BUILDTOP)/include/profile.h $(SRCTOP)/include/port-sockets.h \
  $(SRCTOP)/include/socket-utils.h $(SRCTOP)/include/k5-locate.h \
  $(SRCTOP)/include/kdb.h $(SRCTOP)/include/k5-plugin.h \
  $(SRCTOP)/lib/kdb/kdb5.h $(SRCTOP)/lib/kdb_ldap/kdb_ldap.h \
  $(SRCTOP)/lib/kdb_ldap/ldap_krbcontainer.h $(SRCTOP)/lib/kdb_ldap/ldap_realm.h \
  $(SRCTOP)/lib/kdb_ldap/ldap_principal.h $(SRCTOP)/lib/kdb_ldap/ldap_tkt_policy.h \
  $(SRCTOP)/lib/kdb_ldap/ldap_pwd_policy.h
