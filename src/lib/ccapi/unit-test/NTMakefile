!include <win32.mak>

CFLAGS = -I../include $(cdebug) $(cflags) $(cvarsmt)

WINLIBS = ws2_32.lib rpcrt4.lib $(guilibsdll)

T_CCACHE = t_ccache.exe

T_CONTEXT = t_context.exe

T_LISTS = t_lists.exe

T_MSG = t_msg.exe

T_SERVER = t_server.exe

all:  $(T_CCACHE) $(T_CONTEXT) $(T_LISTS) $(T_MSG) $(T_SERVER)

ntccrpc_c.c ntccrpc_s.c ntccrpc.h: ntccrpc.idl ntccrpc.acf
	midl ntccrpc.idl /acf ntccrpc.acf

CC_CLIENT_LIB = ..\client\cc_client.lib

CC_COMMON_LIB = ..\common\cc_common.lib

CC_SERVER_LIB = ..\server\cc_server.lib

CC_API_LIB = ..\windows\krbcc32.lib

$(T_CCACHE): t_ccache.obj $(CC_SERVER_LIB) $(CC_COMMON_LIB)
	$(link) /NOLOGO $(conlibsmt) $(ldebug) $(conlflags) /OUT:$@ $** $(WINLIBS)

$(T_CONTEXT): t_context.obj $(CC_SERVER_LIB) $(CC_COMMON_LIB)
	$(link) /NOLOGO $(conlibsmt) $(ldebug) $(conlflags) /OUT:$@ $** $(WINLIBS)

$(T_LISTS): t_lists.obj $(CC_SERVER_LIB) $(CC_COMMON_LIB)
	$(link) /NOLOGO $(conlibsmt) $(ldebug) $(conlflags) /OUT:$@ $** $(WINLIBS)

$(T_MSG): t_msg.obj $(CC_SERVER_LIB) $(CC_COMMON_LIB)
	$(link) /NOLOGO $(conlibsmt) $(ldebug) $(conlflags) /OUT:$@ $** $(WINLIBS)

$(T_SERVER): t_server.obj $(CC_SERVER_LIB) $(CC_COMMON_LIB)
	$(link) /NOLOGO $(conlibsmt) $(ldebug) $(conlflags) /OUT:$@ $** $(WINLIBS)

clean:
	del *.exe *.dll *.lib *.exp *.obj ntccrpc_c.c ntccrpc_s.c ntccrpc.h


