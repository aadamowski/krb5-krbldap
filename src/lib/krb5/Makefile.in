##DOSBUILDTOP = ..\..

ANAME_DBDEP=@ANAME_DBDEP@
ANAME_DBLIB=@ANAME_DBLIB@

TST=if test -n "`cat DONE`" ; then

MAC_SUBDIRS = error_tables asn.1 ccache keytab krb rcache free os posix 

LIB_SUBDIRS= error_tables asn.1 ccache ccache/stdio ccache/file ccache/memory \
	keytab keytab/file krb rcache free os posix \
        $(BUILDTOP)/util/profile
LIBUPDATE= $(BUILDTOP)/util/libupdate
LIBDONE= error_tables/DONE asn.1/DONE ccache/DONE ccache/stdio/DONE \
		ccache/file/DONE ccache/memory/DONE keytab/DONE \
		keytab/file/DONE krb/DONE rcache/DONE free/DONE os/DONE \
		posix/DONE $(BUILDTOP)/util/profile/DONE

#
#SHLIB_LIBS=-lcrypto -lcom_err $(ANAME_DBLIB) @SHLIB_GEN@
#SHLIB_LDFLAGS= $(LDFLAGS) @SHLIB_RPATH_DIRS@	
#	$(LD_UNRESOLVED_PREFIX)_et_list $(LD_UNRESOLVED_PREFIX)error_message
#SHLIB_LIBDIRS= @SHLIB_LIBDIRS@

LIB=krb5
LIBMAJOR=1
LIBMINOR=0

STOBJLISTS= \
	error_tables/OBJS.ST \
	asn.1/OBJS.ST \
	ccache/OBJS.ST ccache/stdio/OBJS.ST ccache/file/OBJS.ST \
	ccache/memory/OBJS.ST \
	keytab/OBJS.ST keytab/file/OBJS.ST \
	krb/OBJS.ST \
	rcache/OBJS.ST \
	free/OBJS.ST \
	os/OBJS.ST \
	posix/OBJS.ST \
	$(BUILDTOP)/util/profile/OBJS.ST

RELDIR=krb5
SHLIB_EXPDEPS = \
	$(TOPLIBD)/libcrypto$(SHLIBEXT) \
	$(TOPLIBD)/libcom_err$(SHLIBEXT)
SHLIB_EXPLIBS=-lcrypto -lcom_err @SHLIB_GEN@
SHLIB_DIRS=-L$(TOPLIBD)
SHLIB_RDIRS=$(KRB5_LIBDIR)

all-unix:: all-liblinks

all-windows::

clean-unix:: clean-liblinks clean-libs

clean-windows::
	$(RM) krb5.lib krb5.bak

all-windows::
	cd ASN.1
	@echo Making in lib\asn.1
	-$(MAKE) -$(MFLAGS)
	cd ..\CCACHE
	@echo Making in lib\ccache
	-$(MAKE) -$(MFLAGS)
	cd ..\error_tables
	@echo Making in lib\error_tables
	-$(MAKE) -$(MFLAGS)
	cd ..\FREE
	@echo Making in lib\free
	-$(MAKE) -$(MFLAGS)
	cd ..\KEYTAB
	@echo Making in lib\keytab
	-$(MAKE) -$(MFLAGS)
	cd ..\KRB
	@echo Making in lib\krb
	-$(MAKE) -$(MFLAGS)
	cd ..\OS
	@echo Making in lib\os
	-$(MAKE) -$(MFLAGS)
	cd ..\POSIX
	@echo Making in lib\posix
	-$(MAKE) -$(MFLAGS)
	cd ..\RCACHE
	@echo Making in lib\rcache
	-$(MAKE) -$(MFLAGS)
	cd ..

clean-windows::
	cd ASN.1
	@echo Making clean in lib\asn.1
	-$(MAKE) -$(MFLAGS) clean
	cd ..\CCACHE
	@echo Making clean in lib\ccache
	-$(MAKE) -$(MFLAGS) clean
	cd ..\error_tables
	@echo Making clean in lib\error_tables
	-$(MAKE) -$(MFLAGS) clean
	cd ..\FREE
	@echo Making clean in lib\free
	-$(MAKE) -$(MFLAGS) clean
	cd ..\KEYTAB
	@echo Making clean in lib\keytab
	-$(MAKE) -$(MFLAGS) clean
	cd ..\KRB
	@echo Making clean in lib\krb
	-$(MAKE) -$(MFLAGS) clean
	cd ..\OS
	@echo Making clean in lib\os
	-$(MAKE) -$(MFLAGS) clean
	cd ..\POSIX
	@echo Making clean in lib\posix
	-$(MAKE) -$(MFLAGS) clean
	cd ..\RCACHE
	@echo Making clean in lib\rcache
	-$(MAKE) -$(MFLAGS) clean
	cd ..
	@echo Making clean locally

