CFLAGS = $(CCOPTS) $(DEFS) -I$(srcdir)$(S)file -I$(srcdir)$(S)stdio

##DOSBUILDTOP = ..\..\..
##DOSMYNAME=ccache
##DOSOBJFILE=..\$(MYNAME).lst
##WIN16##LIBNAME=..\krb5.lib

MAC_SUBDIRS = file stdio

.c.o:
	$(CC) $(CFLAGS) -c $(srcdir)/$*.c
@SHARED_RULE@

OBJS=	ccbase.$(OBJEXT) \
	ccdefault.$(OBJEXT) \
	ccdefops.$(OBJEXT) \
	ser_cc.$(OBJEXT)

SRCS=	$(srcdir)/ccbase.c \
	$(srcdir)/ccdefault.c \
	$(srcdir)/ccdefops.c \
	$(srcdir)/ser_cc.c

all-unix:: shared $(OBJS) 

all-mac:: $(OBJS) 
all-windows:: subdirs $(OBJFILE) 

##DOSsubdirs:: file\file.lst
##DOSfile\file.lst::
##DOS	cd file
##DOS	@echo Making in krb5\ccache\file
##DOS	-$(MAKE) -$(MFLAGS)
##DOS	cd ..

##DOS$(OBJFILE): $(OBJS) file\file.lst
##DOS	$(RM) $(OBJFILE)
##WIN16##	$(CP) nul: $(OBJFILE)
##WIN32##	$(LIBECHO) -p $(MYNAME)\ *.obj file\*.obj > $(OBJFILE)

shared: 
	mkdir shared

clean-unix::
	$(RM) shared/*

clean-mac:
clean-windows::
	cd file
	@echo Making clean in krb5\ccache\file
	-$(MAKE) -$(MFLAGS) clean
	cd ..
	@echo Making clean in krb5\ccache
	$(RM) $(OBJFILE)
