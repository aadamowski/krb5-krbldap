CFLAGS = $(CCOPTS) $(DEFS)

##DOSBUILDTOP = ..\..\..
##DOSMYNAME=keytab
##DOSOBJFILE=..\$(MYNAME).lst
##WIN16##LIBNAME=..\krb5.lib

MAC_SUBDIRS = file

.c.o:
	$(CC) $(CFLAGS) -c $(srcdir)/$*.c
@SHARED_RULE@

OBJS=	\
	ktadd.$(OBJEXT)		\
	ktbase.$(OBJEXT)	\
	ktdefault.$(OBJEXT)	\
	ktfr_entry.$(OBJEXT)	\
	ktremove.$(OBJEXT)	\
	read_servi.$(OBJEXT)

SRCS=	\
	$(srcdir)/ktadd.c	\
	$(srcdir)/ktbase.c	\
	$(srcdir)/ktdefault.c	\
	$(srcdir)/ktfr_entry.c	\
	$(srcdir)/ktremove.c	\
	$(srcdir)/read_servi.c

shared:
	mkdir shared

all-unix:: shared $(OBJS)
all-mac:: $(OBJS)
all-windows:: subdirs $(OBJFILE)

##DOSsubdirs:: file\file.lst
##DOSfile\file.lst::
##DOS	cd file
##DOS	@echo Making in krb5\keytab\file
##DOS	-$(MAKE) -$(MFLAGS)
##DOS	cd ..

##DOS$(OBJFILE): $(OBJS) file\file.lst
##DOS	$(RM) $(OBJFILE)
##WIN16##	$(CP) nul: $(OBJFILE)
##WIN32##	$(LIBECHO) -p $(MYNAME)\ *.obj file\*.obj > $(OBJFILE)

clean-unix::
	$(RM) shared/*

clean-mac::
clean-windows::
	cd file
	@echo Making clean in krb5\keytab\file
	-$(MAKE) -$(MFLAGS) clean
	cd ..
	@echo Making clean in krb5\keytab
	$(RM) $(OBJFILE)

