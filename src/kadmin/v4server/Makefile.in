CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDE) \
	-DOVSEC_KADM -DUSE_KADM5_API_VERSION=1 -DNEED_SOCKETS
PROG_LIBPATH=-L$(TOPLIBD) $(KRB4_LIBPATH)
PROG_RPATH=$(KRB5_LIBDIR)

LOCALINCLUDE = $(KRB4_INCLUDES)

PROG = kadmind4
OBJS = kadm_server.o admin_server.o kadm_ser_wrap.o \
	kadm_stream.o kadm_supp.o acl_files.o kadm_err.o

all:: $(PROG)

kadm_err.c kadm_err.h: $(srcdir)/kadm_err.et

$(OBJS): kadm_err.h

$(PROG): $(OBJS) $(KADMCLNT_DEPLIBS) $(DB_DEPLIB) $(KRB4COMPAT_DEPLIBS)
	$(CC_LINK) -o $(PROG) $(OBJS) $(KADMCLNT_LIBS) $(DB_LIB) $(KRB4COMPAT_LIBS)

install::
	$(INSTALL_PROGRAM) $(PROG) ${DESTDIR}$(ADMIN_BINDIR)/$(PROG)

clean::
	$(RM) $(PROG) $(OBJS)
	$(RM) kadm_err.h kadm_err.c
